<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Learn Vim (the Smart Way) - 13&nbsp; Ch13. the Global Command</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
q { quotes: "“" "”" "‘" "’"; }
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/ch14_external_commands.md.html" rel="next">
<link href="../chapters/ch12_search_and_substitute.md.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ch13. the Global Command</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Learn Vim (the Smart Way)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/iggredible/Learn-Vim" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch01_starting_vim.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Ch01. Starting Vim</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch02_buffers_windows_tabs.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Ch02. Buffers, Windows, and Tabs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch03_searching_files.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ch03. Searching Files</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch04_vim_grammar.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ch04. Vim Grammar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch05_moving_in_file.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ch05. Moving in a File</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch06_insert_mode.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ch06. Insert Mode</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch07_the_dot_command.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ch07. the Dot Command</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch08_registers.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ch08. Registers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch09_macros.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Ch09. Macros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch10_undo.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Ch10. Undo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch11_visual_mode.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Ch11. Visual Mode</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch12_search_and_substitute.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Ch12. Search and Substitute</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch13_the_global_command.md.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ch13. the Global Command</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch14_external_commands.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ch14. External Commands</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch15_command-line_mode.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ch15. Command-line Mode</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch16_tags.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Ch16. Tags</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch17_fold.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Ch17. Fold</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch18_git.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Ch18. Git</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch19_compile.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Ch19. Compile</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch20_views_sessions_viminfo.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Ch20. Views, Sessions, and Viminfo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch21_multiple_file_operations.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple File Operations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch22_vimrc.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Ch22. Vimrc</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch23_vim_packages.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ch23. Vim Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch24_vim_runtime.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Ch24. Vim Runtime</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch25_vimscript_basic_data_types.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Ch25. Vimscript Basic Data Types</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch26_vimscript_conditionals_and_loops.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Ch26. Vimscript Conditionals and Loops</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch27_vimscript_variable_scopes.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Ch27. Vimscript Variable Scopes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch28_vimscript_functions.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Ch28. Vimscript Functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch29_plugin_example_writing-a-titlecase-plugin.md.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Ch29. Write a Plugin: Creating a Titlecase Operator</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#global-command-overview" id="toc-global-command-overview" class="nav-link active" data-scroll-target="#global-command-overview"><span class="toc-section-number">13.1</span>  Global Command Overview</a></li>
  <li><a href="#inverse-match" id="toc-inverse-match" class="nav-link" data-scroll-target="#inverse-match"><span class="toc-section-number">13.2</span>  Inverse Match</a></li>
  <li><a href="#pattern" id="toc-pattern" class="nav-link" data-scroll-target="#pattern"><span class="toc-section-number">13.3</span>  Pattern</a></li>
  <li><a href="#passing-a-range" id="toc-passing-a-range" class="nav-link" data-scroll-target="#passing-a-range"><span class="toc-section-number">13.4</span>  Passing a Range</a></li>
  <li><a href="#normal-command" id="toc-normal-command" class="nav-link" data-scroll-target="#normal-command"><span class="toc-section-number">13.5</span>  Normal Command</a></li>
  <li><a href="#executing-a-macro" id="toc-executing-a-macro" class="nav-link" data-scroll-target="#executing-a-macro"><span class="toc-section-number">13.6</span>  Executing a Macro</a></li>
  <li><a href="#recursive-global-command" id="toc-recursive-global-command" class="nav-link" data-scroll-target="#recursive-global-command"><span class="toc-section-number">13.7</span>  Recursive Global Command</a></li>
  <li><a href="#changing-the-delimiter" id="toc-changing-the-delimiter" class="nav-link" data-scroll-target="#changing-the-delimiter"><span class="toc-section-number">13.8</span>  Changing the Delimiter</a></li>
  <li><a href="#the-default-command" id="toc-the-default-command" class="nav-link" data-scroll-target="#the-default-command"><span class="toc-section-number">13.9</span>  The Default Command</a></li>
  <li><a href="#reversing-the-entire-buffer" id="toc-reversing-the-entire-buffer" class="nav-link" data-scroll-target="#reversing-the-entire-buffer"><span class="toc-section-number">13.10</span>  Reversing the Entire Buffer</a></li>
  <li><a href="#aggregating-all-todos" id="toc-aggregating-all-todos" class="nav-link" data-scroll-target="#aggregating-all-todos"><span class="toc-section-number">13.11</span>  Aggregating All Todos</a></li>
  <li><a href="#black-hole-delete" id="toc-black-hole-delete" class="nav-link" data-scroll-target="#black-hole-delete"><span class="toc-section-number">13.12</span>  Black Hole Delete</a></li>
  <li><a href="#reduce-multiple-empty-lines-to-one-empty-line" id="toc-reduce-multiple-empty-lines-to-one-empty-line" class="nav-link" data-scroll-target="#reduce-multiple-empty-lines-to-one-empty-line"><span class="toc-section-number">13.13</span>  Reduce Multiple Empty Lines to One Empty Line</a></li>
  <li><a href="#advanced-sort" id="toc-advanced-sort" class="nav-link" data-scroll-target="#advanced-sort"><span class="toc-section-number">13.14</span>  Advanced Sort</a></li>
  <li><a href="#learn-the-global-command-the-smart-way" id="toc-learn-the-global-command-the-smart-way" class="nav-link" data-scroll-target="#learn-the-global-command-the-smart-way"><span class="toc-section-number">13.15</span>  Learn the Global Command the Smart Way</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ch13. the Global Command</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>So far you have learned how to repeat the last change with the dot command (<code>.</code>), to replay actions with macros (<code>q</code>), and to store texts in the registers (<code>"</code>).</p>
<p>In this chapter, you will learn how to repeat a command-line command with the global command.</p>
<section id="global-command-overview" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="global-command-overview"><span class="header-section-number">13.1</span> Global Command Overview</h2>
<p>Vim’s global command is used to run a command-line command on multiple lines simultaneously.</p>
<p>By the way, you may have heard of the term <q>Ex Commands</q> before. In this guide, I refer them as command-line commands. Both Ex commands and command-line commands are the same. They are the commands that start with a colon (<code>:</code>). The substitute command in the last chapter was an example of an Ex command. They are called Ex because they originally came from the Ex text editor. I will continue to refer to them as command-line commands in this guide. For a full list of Ex commands, check out <code>:h ex-cmd-index</code>.</p>
<p>The global command has the following syntax:</p>
<pre><code>:g/pattern/command</code></pre>
<p>The <code>pattern</code> matches all lines containing that pattern, similar to the pattern in the substitute command. The <code>command</code> can be any command-line command. The global command works by executing <code>command</code> against each line that matches the <code>pattern</code>.</p>
<p>If you have the following expressions:</p>
<pre><code>const one = 1;
console.log("one: ", one);

const two = 2;
console.log("two: ", two);

const three = 3;
console.log("three: ", three);</code></pre>
<p>To remove all lines containing <q>console</q>, you can run:</p>
<pre><code>:g/console/d</code></pre>
<p>Result:</p>
<pre><code>const one = 1;

const two = 2;

const three = 3;</code></pre>
<p>The global command executes the delete command (<code>d</code>) on all lines that match the <q>console</q> pattern.</p>
<p>When running the <code>g</code> command, Vim makes two scans across the file. On the first run, it scans each line and marks the line that matches the <code>/console/</code> pattern. Once all the matching lines are marked, it goes for the second time and executes the <code>d</code> command on the marked lines.</p>
<p>If you want to delete all lines containing <q>const</q> instead, run:</p>
<pre><code>:g/const/d</code></pre>
<p>Result:</p>
<pre><code>console.log("one: ", one);

console.log("two: ", two);

console.log("three: ", three);</code></pre>
</section>
<section id="inverse-match" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="inverse-match"><span class="header-section-number">13.2</span> Inverse Match</h2>
<p>To run the global command on non-matching lines, you can run:</p>
<pre><code>:g!/pattern/command</code></pre>
<p>or</p>
<pre><code>:v/pattern/command</code></pre>
<p>If you run <code>:v/console/d</code>, it will delete all lines <em>not</em> containing <q>console</q>.</p>
</section>
<section id="pattern" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="pattern"><span class="header-section-number">13.3</span> Pattern</h2>
<p>The global command uses the same pattern system as the substitute command, so this section will serve as a refresher. Feel free to skip to the next section or read along!</p>
<p>If you have these expressions:</p>
<pre><code>const one = 1;
console.log("one: ", one);

const two = 2;
console.log("two: ", two);

const three = 3;
console.log("three: ", three);</code></pre>
<p>To delete the lines containing either <q>one</q> or <q>two</q>, run:</p>
<pre><code>:g/one\|two/d</code></pre>
<p>To delete the lines containing any single digits, run either:</p>
<pre><code>:g/[0-9]/d</code></pre>
<p>or</p>
<pre><code>:g/\d/d</code></pre>
<p>If you have the expression:</p>
<pre><code>const oneMillion = 1000000;
const oneThousand = 1000;
const one = 1;</code></pre>
<p>To match the lines containing between three to six zeroes, run:</p>
<pre><code>:g/0\{3,6\}/d</code></pre>
</section>
<section id="passing-a-range" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="passing-a-range"><span class="header-section-number">13.4</span> Passing a Range</h2>
<p>You can pass a range before the <code>g</code> command. Here are some ways you can do it: - <code>:1,5g/console/d</code> matches the string <q>console</q> between lines 1 and 5 and deletes them. - <code>:,5g/console/d</code> if there is no address before the comma, then it starts from the current line. It looks for the string <q>console</q> between the current line and line 5 and deletes them. - <code>:3,g/console/d</code> if there is no address after the comma, then it ends at the current line. It looks for the string <q>console</q> between line 3 and the current line and deletes them. - <code>:3g/console/d</code> if you only pass one address without a comma, it executes the command only on line 3. It looks on line 3 and deletes it if has the string <q>console</q>.</p>
<p>In addition to numbers, you can also use these symbols as range: - <code>.</code> means the current line. A range of <code>.,3</code> means between the current line and line 3. - <code>$</code> means the last line in the file. <code>3,$</code> range means between line 3 and the last line. - <code>+n</code> means n lines after the current line. You can use it with <code>.</code> or without. <code>3,+1</code> or <code>3,.+1</code> means between line 3 and the line after the current line.</p>
<p>If you don’t give it any range, by default it affects the entire file. This is actually not the norm. Most of Vim’s command-line commands run on only the current line if you don’t pass it any range. The two notable exceptions are the global (<code>:g</code>) and the save (<code>:w</code>) commands.</p>
</section>
<section id="normal-command" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="normal-command"><span class="header-section-number">13.5</span> Normal Command</h2>
<p>You can run a normal command with the global command with <code>:normal</code> command-line command.</p>
<p>If you have this text:</p>
<pre><code>const one = 1
console.log("one: ", one)

const two = 2
console.log("two: ", two)

const three = 3
console.log("three: ", three)</code></pre>
<p>To add a <q>;</q> to the end of each line, run:</p>
<pre><code>:g/./normal A;</code></pre>
<p>Let’s break it down: - <code>:g</code> is the global command. - <code>/./</code> is a pattern for <q>non-empty lines</q>. It matches the lines with at least one character, so it matches the lines with <q>const</q> and <q>console</q> and it does not match empty lines. - <code>normal A;</code> runs the <code>:normal</code> command-line command. <code>A;</code> is the normal mode command to insert a <q>;</q> at the end of the line.</p>
</section>
<section id="executing-a-macro" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="executing-a-macro"><span class="header-section-number">13.6</span> Executing a Macro</h2>
<p>You can also execute a macro with the global command. A macro can be executed with the <code>normal</code> command. If you have the expressions:</p>
<pre><code>const one = 1
console.log("one: ", one);

const two = 2
console.log("two: ", two);

const three = 3
console.log("three: ", three);</code></pre>
<p>Notice that the lines with <q>const</q> do not have semi-colons. Let’s create a macro to add a comma to the end of those lines in the register a:</p>
<pre><code>qaA;&lt;Esc&gt;q</code></pre>
<p>If you need a refresher, check out the chapter on macro. Now run:</p>
<pre><code>:g/const/normal @a</code></pre>
<p>Now all lines with <q>const</q> will have a <q>;</q> at the end.</p>
<pre><code>const one = 1;
console.log("one: ", one);

const two = 2;
console.log("two: ", two);

const three = 3;
console.log("three: ", three);</code></pre>
<p>If you followed this step-by-step, you will have two semi-colons on the first line. To avoid that, run the global command on line two onward, <code>:2,$g/const/normal @a</code>.</p>
</section>
<section id="recursive-global-command" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="recursive-global-command"><span class="header-section-number">13.7</span> Recursive Global Command</h2>
<p>The global command itself is a type of a command-line command, so you can technically run the global command inside a global command.</p>
<p>Given the following expressions, if you want to delete the second <code>console.log</code> statement:</p>
<pre><code>const one = 1;
console.log("one: ", one);

const two = 2;
console.log("two: ", two);

const three = 3;
console.log("three: ", three);</code></pre>
<p>If you run:</p>
<pre><code>:g/console/g/two/d</code></pre>
<p>First, <code>g</code> will look for the lines containing the pattern <q>console</q> and will find 3 matches. Then the second <code>g</code> will look for the line containing the pattern <q>two</q> from those three matches. Finally, it will delete that match.</p>
<p>You can also combine <code>g</code> with <code>v</code> to find positive and negative patterns. For example:</p>
<pre><code>:g/console/v/two/d</code></pre>
<p>Instead of looking for the line containing the pattern <q>two</q>, it will look for the lines <em>not</em> containing the pattern <q>two</q>.</p>
</section>
<section id="changing-the-delimiter" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="changing-the-delimiter"><span class="header-section-number">13.8</span> Changing the Delimiter</h2>
<p>You can change the global command’s delimiter like the substitute command. The rules are the same: you can use any single byte character except for alphabets, numbers, <code>"</code>, <code>|</code>, and <code>\</code>.</p>
<p>To delete the lines containing <q>console</q>:</p>
<pre><code>:g@console@d</code></pre>
<p>If you are using the substitute command with the global command, you can have two different delimiters:</p>
<pre><code>g@one@s+const+let+g</code></pre>
<p>Here the global command will look for all lines containing <q>one</q>. The substitute command will substitute, from those matches, the string <q>const</q> with <q>let</q>.</p>
</section>
<section id="the-default-command" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="the-default-command"><span class="header-section-number">13.9</span> The Default Command</h2>
<p>What happens if you don’t specify any command-line command in the global command?</p>
<p>The global command will use the print (<code>:p</code>) command to print the current line’s text. If you run:</p>
<pre><code>:g/console</code></pre>
<p>It will print at the bottom of the screen all the lines containing <q>console</q>.</p>
<p>By the way, here is one interesting fact. Because the default command used by the global command is <code>p</code>, this makes the <code>g</code> syntax to be:</p>
<pre><code>:g/re/p</code></pre>
<ul>
<li><code>g</code> = the global command</li>
<li><code>re</code> = the regex pattern</li>
<li><code>p</code> = the print command</li>
</ul>
<p>It spells <em><q>grep</q></em>, the same <code>grep</code> from the command line. This is <strong>not</strong> a coincidence. The <code>g/re/p</code> command originally came from the Ed Editor, one of the original line text editors. The <code>grep</code> command got its name from Ed.</p>
<p>Your computer probably still has the Ed editor. Run <code>ed</code> from the terminal (hint: to quit, type <code>q</code>).</p>
</section>
<section id="reversing-the-entire-buffer" class="level2" data-number="13.10">
<h2 data-number="13.10" class="anchored" data-anchor-id="reversing-the-entire-buffer"><span class="header-section-number">13.10</span> Reversing the Entire Buffer</h2>
<p>To reverse the entire file, run:</p>
<pre><code>:g/^/m 0</code></pre>
<p><code>^</code> is a pattern for the beginning of a line. Use <code>^</code> to match all lines, including empty lines.</p>
<p>If you need to reverse only a few lines, pass it a range. To reverse the lines between line five to line ten, run:</p>
<pre><code>:5,10g/^/m 0</code></pre>
<p>To learn more about the move command, check out <code>:h :move</code>.</p>
</section>
<section id="aggregating-all-todos" class="level2" data-number="13.11">
<h2 data-number="13.11" class="anchored" data-anchor-id="aggregating-all-todos"><span class="header-section-number">13.11</span> Aggregating All Todos</h2>
<p>When coding, sometimes I would write TODOs in the file I’m editing:</p>
<pre><code>const one = 1;
console.log("one: ", one);
// TODO: feed the puppy

const two = 2;
// TODO: feed the puppy automatically
console.log("two: ", two);

const three = 3;
console.log("three: ", three);
// TODO: create a startup selling an automatic puppy feeder</code></pre>
<p>It can be hard to keep track of all the created TODOs. Vim has a <code>:t</code> (copy) method to copy all matches to an address. To learn more about the copy method, check out <code>:h :copy</code>.</p>
<p>To copy all TODOs to the end of the file for easier introspection, run:</p>
<pre><code>:g/TODO/t $</code></pre>
<p>Result:</p>
<pre><code>const one = 1;
console.log("one: ", one);
// TODO: feed the puppy

const two = 2;
// TODO: feed the puppy automatically
console.log("two: ", two);

const three = 3;
console.log("three: ", three);
// TODO: create a startup selling an automatic puppy feeder

// TODO: feed the puppy
// TODO: feed the puppy automatically
// TODO: create a startup selling an automatic puppy feeder</code></pre>
<p>Now I can review all the TODOs I created, find a time to do them or delegate them to someone else, and continue to work on my next task.</p>
<p>If instead of copying them you want to move all the TODOs to the end, use the move command, <code>:m</code>:</p>
<pre><code>:g/TODO/m $</code></pre>
<p>Result:</p>
<pre><code>const one = 1;
console.log("one: ", one);

const two = 2;
console.log("two: ", two);

const three = 3;
console.log("three: ", three);

// TODO: feed the puppy
// TODO: feed the puppy automatically
// TODO: create a startup selling an automatic puppy feeder</code></pre>
</section>
<section id="black-hole-delete" class="level2" data-number="13.12">
<h2 data-number="13.12" class="anchored" data-anchor-id="black-hole-delete"><span class="header-section-number">13.12</span> Black Hole Delete</h2>
<p>Recall from the register chapter that deleted texts are stored inside the numbered registers (granted they are sufficiently large ). Whenever you run <code>:g/console/d</code>, Vim stores the deleted lines in the numbered registers. If you delete many lines, you can quickly fill up all the numbered registers. To avoid this, you can always use the black hole register (<code>"_</code>) to <em>not</em> store your deleted lines into the registers. Run:</p>
<pre><code>:g/console/d_</code></pre>
<p>By passing <code>_</code> after <code>d</code>, Vim won’t use up your scratch registers.</p>
</section>
<section id="reduce-multiple-empty-lines-to-one-empty-line" class="level2" data-number="13.13">
<h2 data-number="13.13" class="anchored" data-anchor-id="reduce-multiple-empty-lines-to-one-empty-line"><span class="header-section-number">13.13</span> Reduce Multiple Empty Lines to One Empty Line</h2>
<p>If you have a text with multiple empty lines:</p>
<pre><code>const one = 1;
console.log("one: ", one);


const two = 2;
console.log("two: ", two);





const three = 3;
console.log("three: ", three);</code></pre>
<p>You can quickly reduce the empty lines into one empty line with:</p>
<pre><code>:g/^$/,/./-1j</code></pre>
<p>Result:</p>
<pre><code>const one = 1;
console.log("one: ", one);

const two = 2;
console.log("two: ", two);

const three = 3;
console.log("three: ", three);</code></pre>
<p>Normally the global command accepts the following form: <code>:g/pattern/command</code>. However, you can also run the global command with the following form: <code>:g/pattern1/,/pattern2/command</code>. With this, Vim will apply the <code>command</code> within <code>pattern1</code> and <code>pattern2</code>.</p>
<p>With that in mind, let’s break down the command <code>:g/^$/,/./-1j</code> according to <code>:g/pattern1/,/pattern2/command</code>: - <code>/pattern1/</code> is <code>/^$/</code>. It represents an empty line (a line with zero character). - <code>/pattern2/</code> is <code>/./</code> with <code>-1</code> line modifier. <code>/./</code> represents a non-empty line (a line with at least one character). The <code>-1</code> means the line above that. - <code>command</code> is <code>j</code>, the join command (<code>:j</code>). In this context, this global command joins all the given lines.</p>
<p>By the way, if you want to reduce multiple empty lines to no lines, run this instead:</p>
<pre><code>:g/^$/,/./j</code></pre>
<p>A simpler alternative:</p>
<pre><code>:g/^$/-j</code></pre>
<p>Your text is now reduced to:</p>
<pre><code>const one = 1;
console.log("one: ", one);
const two = 2;
console.log("two: ", two);
const three = 3;
console.log("three: ", three);</code></pre>
</section>
<section id="advanced-sort" class="level2" data-number="13.14">
<h2 data-number="13.14" class="anchored" data-anchor-id="advanced-sort"><span class="header-section-number">13.14</span> Advanced Sort</h2>
<p>Vim has a <code>:sort</code> command to sort the lines within a range. For example:</p>
<pre><code>d
b
a
e
c</code></pre>
<p>You can sort them by running <code>:sort</code>. If you give it a range, it will sort only the lines within that range. For example, <code>:3,5sort</code> only sorts lines three and five.</p>
<p>If you have the following expressions:</p>
<pre><code>const arrayB = [
  "i",
  "g",
  "h",
  "b",
  "f",
  "d",
  "e",
  "c",
  "a",
]

const arrayA = [
  "h",
  "b",
  "f",
  "d",
  "e",
  "a",
  "c",
]</code></pre>
<p>If you need to sort the elements inside the arrays, but not the arrays themselves, you can run this:</p>
<pre><code>:g/\[/+1,/\]/-1sort</code></pre>
<p>Result:</p>
<pre><code>const arrayB = [
  "a",
  "b",
  "c",
  "d",
  "e",
  "f",
  "g",
  "h",
  "i",
]

const arrayA = [
  "a"
  "b",
  "c",
  "d",
  "e",
  "f",
  "h",
]</code></pre>
<p>This is great! But the command looks complicated. Let’s break it down. This command also follows the form <code>:g/pattern1/,/pattern2/command</code>.</p>
<ul>
<li><code>:g</code> is the global command pattern.</li>
<li><code>/\[/+1</code> is the first pattern. It matches a literal left square bracket <q>[</q>. The <code>+1</code> refers to the line below it.</li>
<li><code>/\]/-1</code> is the second pattern. It matches a literal right square bracket <q>]</q>. The <code>-1</code> refers to the line above it.</li>
<li><code>/\[/+1,/\]/-1</code> then refers to any lines between <q>[” and ”]</q>.</li>
<li><code>sort</code> is a command-line command to sort.</li>
</ul>
</section>
<section id="learn-the-global-command-the-smart-way" class="level2" data-number="13.15">
<h2 data-number="13.15" class="anchored" data-anchor-id="learn-the-global-command-the-smart-way"><span class="header-section-number">13.15</span> Learn the Global Command the Smart Way</h2>
<p>The global command executes the command-line command against all matching lines. With it, you only need to run a command once and Vim will do the rest for you. To become proficient at the global command, two things are required: a good vocabulary of command-line commands and a knowledge of regular expressions. As you spend more time using Vim, you will naturally learn more command-line commands. A regular expression knowledge will require a more active approach. But once you become comfortable with regular expressions, you will be ahead of many.</p>
<p>Some of the examples here are complicated. Do not be intimidated. Really take your time to understand them. Learn to read the patterns. Do not give up.</p>
<p>Whenever you need to run multiple commands, pause and see if you can use the <code>g</code> command. Identify the best command for the job and write a pattern to target as many things at once.</p>
<p>Now that you know how powerful the global command is, let’s learn how to use the external commands to increase your tool arsenals.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/ch12_search_and_substitute.md.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Ch12. Search and Substitute</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/ch14_external_commands.md.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ch14. External Commands</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>